\documentclass{beamer}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Definicion de paquetes
% \usepackage{minted}
\usepackage[utf8]{inputenc}
\usepackage[spanish]{babel}
\usepackage{hyperref}
\usepackage{xargs}
\usepackage[colorinlistoftodos,prependcaption,textsize=tiny]{todonotes}
\presetkeys{todonotes}{inline}{}
\usepackage{pgfpages}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Definición de comandos
\setlength{\marginparwidth}{2cm}
% \unsure{I'm not sure}
\newcommandx{\unsure}[2][1=]{\todo[linecolor=red,backgroundcolor=red!25,bordercolor=red,#1]{#2}}
% \change{This must be changed}
\newcommandx{\change}[2][1=]{\todo[linecolor=blue,backgroundcolor=blue!25,bordercolor=blue,#1]{#2}}
% \info{Just information}
\newcommandx{\info}[2][1=]{\todo[linecolor=green,backgroundcolor=green!25,bordercolor=green,#1]{#2}}
% \improvement{THIS must be improved}
\newcommandx{\improvement}[2][1=]{\todo[linecolor=orange,backgroundcolor=orange!25,bordercolor=orange,#1]{#2}}
\newcommandx{\thiswillnotshow}[2][1=]{\todo[disable,#1]{#2}}

\graphicspath{ {images/} }
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Beamer
\usetheme{Madrid}
% \AtBeginEnvironment{minted}{\fontsize{12}{12}\selectfont}
% \setbeameroption{show notes on second screen=right}
% \setbeameroption{show notes}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Título
\title[SGDI]{RabbitMQ}
\author[S. García \and M. Ruiz]{Sergio García Sánchez \and Miguel Emilio Ruiz Nieto}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Empieza el documento
\begin{document}
  \begin{frame}
    \titlepage
  \end{frame}

  \begin{frame}{Contenidos}
    \tableofcontents[hideallsubsections]
  \end{frame}

  \section{Introducción}
  \begin{frame}{Introducción}
    \begin{itemize}
      \item Los servicios web no tienen la capacidad de gestionar\\
      las peticiones que le llegan en un mismo momento
      \item<2-> Ejemplos:
      \begin{itemize}
        \item Web de venta de entradas ante un evento importante
        \item Servicio de videojuego online con alta demanda de
        usuarios
      \end{itemize}
      \item<3-> Como consecuencia:
      \begin{itemize}
        \item Caída del servicio
        \item Pérdida económica
        \item Pérdida de reputación
      \end{itemize}
    \end{itemize}
  \end{frame}

  \begin{frame}{Introducción}
    \onslide<+->{\begin{block}{Por tanto}
      Es necesario procesar las peticiones ``poco a poco''
    \end{block}}
    \onslide<+->{\begin{block}{Y para ello}
      Hay que implementar \textbf{una cola de mensajes}
    \end{block}}
  \end{frame}

  \begin{frame}{Introducción. Cola de mensajes}
    % \improvement{Desarrollar esta idea}
    \begin{itemize}
      \item Comuniación asíncrona \textit{service-to-service}
      usado en arquitecturas serverless y microservicios
      \item Usadas para desacoplar procesos con mucha carga de trabajo\\
      o almacenar trabajo \textit{en batch}
    \end{itemize}
    % A message queue is a form of asynchronous service-to-service\\
    % communication used in serverless and microservices architectures.\\
    % Messages are stored on the queue until they are processed and deleted.\\
    % Each message is processed only once, by a single consumer.\\
    % Message queues can be used to decouple heavyweight processing,\\
    % to buffer or batch work, and to smooth spiky workloads
  \end{frame}

  \begin{frame}[plain]{Cola de mensajes}
    \begin{figure}
      \includegraphics[width=\textwidth]{msg_queue.png}
    \end{figure}
  \end{frame}

  \begin{frame}{Ventajas}
    \begin{itemize}
      \item Mejor rendimiento
      \item Mayor fiabilidad
      \item Escalabilidad granular
      \item Desacoplamiento simplificado
    \end{itemize}
    \note{Desarrollar estos puntos}
  \end{frame}

  \begin{frame}{Servicios de colas}
    \todo{Buscar info sobre servicios de colas}
    \todo{discutir con Sergio si hablamos de Servicios de colas}
  \end{frame}

  \begin{frame}{Colas de mensajes. Tipos}
    \begin{itemize}
      \item STOMP
      \begin{itemize}
        \item El protocolo más sencillo
        \item Implementado sobre HTTP
        \item Basado en intercambio de \textit{frames}
      \end{itemize}
      \item MQTT
      \begin{itemize}
        \item Más ligero que STOMP
        \item Construído sobre TCP/IP
        \item Orientado a arquitecturas IoT
        \item Esquema \textit{publisher-suscriber} síncrono
      \end{itemize}
    \end{itemize}
  \end{frame}

  \begin{frame}{Colas de mensajes. Tipos}
    \begin{itemize}
      \item AMQP
      \begin{itemize}
        \item Comunicación asíncrona \textit{publisher-suscriber} mediante \textbf{broker}
        \item Permite el almacenamiento de mensajes
        \item Proporciona balanceo de carga
      \end{itemize}
    \end{itemize}
  \end{frame}

  \begin{frame}[plain]{Colas de mensajes. Tipos}
    \begin{figure}
      \includegraphics[width=\textwidth]{amq_concepts.png}
    \end{figure}
  \end{frame}

  \section{RabbitMQ}
  \begin{frame}{RabbitMQ. Introducción}
    \begin{itemize}
      \item Implementación del broker AMQP en Erlang
      \item Ofrece soporte para HTTP, STOMP y MQTT
    \end{itemize}
  \end{frame}

  \begin{frame}{Exchanges}

  \end{frame}

  \begin{frame}{Topics}

  \end{frame}

  \begin{frame}{Dead Lettering}

  \end{frame}

  \section{Ejemplos prácticos}
  \begin{frame}{Ejemplos prácticos}
    \begin{itemize}
      \item AMQP - Dead Lettering
      \item STOMP over WebSocket
    \end{itemize}
  \end{frame}

  \section{Conclusiones}
  \begin{frame}{Conclusiones}

  \end{frame}

  \section{Bibliografía}
  \begin{frame}{Bibliografía}
    \begin{itemize}
      \item STOMP Protocol Specification \url{https://stomp.github.io}
      \item MQTT Essentials - A Lightweight IoT Protocol
      \item RabbitMQ Esentials
    \end{itemize}
  \end{frame}
\end{document}
